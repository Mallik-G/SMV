
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>smv package &#8212; smv  documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to smv’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="smv-package">
<h1>smv package<a class="headerlink" href="#smv-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-smv.csv_attributes">
<span id="smv-csv-attributes-module"></span><h2>smv.csv_attributes module<a class="headerlink" href="#module-smv.csv_attributes" title="Permalink to this headline">¶</a></h2>
<p>SMV User Run Configuration Parameters</p>
<p>This module defined the SmvRunConfig class which can be mixed-in into an
SmvModule to get user configuration parameters at run-time.</p>
<dl class="function">
<dt id="smv.csv_attributes.CsvAttributes">
<code class="descclassname">smv.csv_attributes.</code><code class="descname">CsvAttributes</code><span class="sig-paren">(</span><em>delimiter=’</em>, <em>’</em>, <em>quotechar=’”’</em>, <em>hasHeader=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/csv_attributes.html#CsvAttributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.csv_attributes.CsvAttributes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-smv.datasetrepo">
<span id="smv-datasetrepo-module"></span><h2>smv.datasetrepo module<a class="headerlink" href="#module-smv.datasetrepo" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="smv.datasetrepo.DataSetRepo">
<em class="property">class </em><code class="descclassname">smv.datasetrepo.</code><code class="descname">DataSetRepo</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="class">
<dt id="smv.datasetrepo.DataSetRepo.Java">
<em class="property">class </em><code class="descname">Java</code><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo.Java"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.Java" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="smv.datasetrepo.DataSetRepo.Java.implements">
<code class="descname">implements</code><em class="property"> = [‘org.tresamigos.smv.IDataSetRepoPy4J’]</em><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.Java.implements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="method">
<dt id="smv.datasetrepo.DataSetRepo.dataSetsForStage">
<code class="descname">dataSetsForStage</code><span class="sig-paren">(</span><em>stageName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo.dataSetsForStage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.dataSetsForStage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.datasetrepo.DataSetRepo.loadDataSet">
<code class="descname">loadDataSet</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo.loadDataSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.loadDataSet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.datasetrepo.DataSetRepo.notFound">
<code class="descname">notFound</code><span class="sig-paren">(</span><em>modUrn</em>, <em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo.notFound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.notFound" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.datasetrepo.DataSetRepo.outputModsForStage">
<code class="descname">outputModsForStage</code><span class="sig-paren">(</span><em>stageName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo.outputModsForStage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.outputModsForStage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.datasetrepo.DataSetRepoFactory">
<em class="property">class </em><code class="descclassname">smv.datasetrepo.</code><code class="descname">DataSetRepoFactory</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepoFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepoFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="class">
<dt id="smv.datasetrepo.DataSetRepoFactory.Java">
<em class="property">class </em><code class="descname">Java</code><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepoFactory.Java"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepoFactory.Java" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="smv.datasetrepo.DataSetRepoFactory.Java.implements">
<code class="descname">implements</code><em class="property"> = [‘org.tresamigos.smv.IDataSetRepoFactoryPy4J’]</em><a class="headerlink" href="#smv.datasetrepo.DataSetRepoFactory.Java.implements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="method">
<dt id="smv.datasetrepo.DataSetRepoFactory.createRepo">
<code class="descname">createRepo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepoFactory.createRepo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepoFactory.createRepo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-smv.dqm">
<span id="smv-dqm-module"></span><h2>smv.dqm module<a class="headerlink" href="#module-smv.dqm" title="Permalink to this headline">¶</a></h2>
<p>SMV DataSet Framework interface</p>
<p>This module defines the abstract classes which formed the SmvDataSet Framework for clients’ projects</p>
<dl class="function">
<dt id="smv.dqm.DQMFix">
<code class="descclassname">smv.dqm.</code><code class="descname">DQMFix</code><span class="sig-paren">(</span><em>condition</em>, <em>fix</em>, <em>name=None</em>, <em>taskPolicy=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#DQMFix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.DQMFix" title="Permalink to this definition">¶</a></dt>
<dd><p>DQMFix will fix a column with a default value</p>
<p>Example:</p>
<blockquote>
<div><p>If “age” greater than 100, make it 100</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">DQMFix</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">),</span> <span class="s1">&#39;age_cap100&#39;</span><span class="p">,</span> <span class="n">FailNone</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="docutils">
<dt>Args:</dt>
<dd>condition (Column): boolean condition that determines when the fix should occur on the records of a DF
fix (Column): the fix to use when replacing a value that does not pass the condition
name (String): optional parameter for naming the DQMFix. if not specified, defaults to the condition text
taskPolicy (DQMTaskPolicy): optional parameter for the DQM policy. if not specified, defaults to FailNone()</dd>
<dt>Returns:</dt>
<dd>(DQMFix): a DQMFix object</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.DQMRule">
<code class="descclassname">smv.dqm.</code><code class="descname">DQMRule</code><span class="sig-paren">(</span><em>rule</em>, <em>name=None</em>, <em>taskPolicy=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#DQMRule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.DQMRule" title="Permalink to this definition">¶</a></dt>
<dd><p>DQMRule defines a requirement on the records of a DF</p>
<p>Example:</p>
<blockquote>
<div><p>Require the sum of “a” and “b” columns less than 100</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">DQMRule</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">col</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;a_b_sum_lt100&#39;</span><span class="p">,</span> <span class="n">FailPercent</span><span class="p">(</span><span class="mf">0.01</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<dl class="docutils">
<dt>Args:</dt>
<dd>rule (Column): boolean condition that defines the requirement on the records of a DF
name (string): optional parameter for naming the DQMRule. if not specified, defaults to the rule text
taskPolicy (DQMTaskPolicy): optional parameter for the DQM policy. if not specified, defaults to FailNone()</dd>
<dt>Returns:</dt>
<dd>(DQMRule): a DQMRule object</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailAny">
<code class="descclassname">smv.dqm.</code><code class="descname">FailAny</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailAny"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailAny" title="Permalink to this definition">¶</a></dt>
<dd><p>Any rule fail or fix with FailAny will cause the entire DF to fail</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(DQMTaskPolicy): policy for DQM Task</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailCount">
<code class="descclassname">smv.dqm.</code><code class="descname">FailCount</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailCount"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailCount" title="Permalink to this definition">¶</a></dt>
<dd><p>Tasks with FailCount(n) will fail the DF if the task is triggered &gt;= n times</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>threshold (int): the threshold after which the DF fails</dd>
<dt>Returns:</dt>
<dd>(DQMTaskPolicy): policy for DQM Task</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailNone">
<code class="descclassname">smv.dqm.</code><code class="descname">FailNone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailNone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailNone" title="Permalink to this definition">¶</a></dt>
<dd><p>Tasks with FailNone will not trigger any DF level policy</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(DQMTaskPolicy): policy for DQM Task</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailParserCountPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailParserCountPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailParserCountPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailParserCountPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>If the total time of parser fails &gt;= threshold, fail the DF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>threshold (int): the threshold after which the DF fails</dd>
<dt>Returns:</dt>
<dd>(DQMPolicy): policy for DQM</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailPercent">
<code class="descclassname">smv.dqm.</code><code class="descname">FailPercent</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailPercent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailPercent" title="Permalink to this definition">¶</a></dt>
<dd><p>Tasks with FailPercent(r) will fail the DF if the task is triggered &gt;= r percent of the
total number of records in the DF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>threshold (double): the threshold after which the DF fails. value is between 0.0 and 1.0</dd>
<dt>Returns:</dt>
<dd>(DQMTaskPolicy): policy for DQM Task</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailTotalFixCountPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailTotalFixCountPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailTotalFixCountPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailTotalFixCountPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>For all the fixes in a DQM, if the total number of times they are triggered is &gt;= threshold, fail the DF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>threshold (int): the threshold after which the DF fails</dd>
<dt>Returns:</dt>
<dd>(DQMPolicy): policy for DQM</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailTotalFixPercentPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailTotalFixPercentPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailTotalFixPercentPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailTotalFixPercentPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>For all the fixes in a DQM, if the total number of times they are triggered is &gt;= threshold * total Records, fail the DF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>threshold (double): the threshold after which the DF fails. value is between 0.0 and 1.0</dd>
<dt>Returns:</dt>
<dd>(DQMPolicy): policy for DQM</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailTotalRuleCountPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailTotalRuleCountPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailTotalRuleCountPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailTotalRuleCountPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>For all the rules in a DQM, if the total number of times they are triggered is &gt;= threshold, fail the DF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>threshold (int): the threshold after which the DF fails</dd>
<dt>Returns:</dt>
<dd>(DQMPolicy): policy for DQM</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailTotalRulePercentPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailTotalRulePercentPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailTotalRulePercentPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailTotalRulePercentPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>For all the rules in a DQM, if the total number of times they are triggered is &gt;= threshold * total Records, fail the DF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>threshold (double): the threshold after which the DF fails. value is between 0.0 and 1.0</dd>
<dt>Returns:</dt>
<dd>(DQMPolicy): policy for DQM</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.SmvDQM">
<code class="descclassname">smv.dqm.</code><code class="descname">SmvDQM</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#SmvDQM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.SmvDQM" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method for Scala SmvDQM</p>
</dd></dl>

</div>
<div class="section" id="module-smv.error">
<span id="smv-error-module"></span><h2>smv.error module<a class="headerlink" href="#module-smv.error" title="Permalink to this headline">¶</a></h2>
<p>Errors thrown by SMV</p>
<dl class="exception">
<dt id="smv.error.SmvRuntimeError">
<em class="property">exception </em><code class="descclassname">smv.error.</code><code class="descname">SmvRuntimeError</code><span class="sig-paren">(</span><em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/error.html#SmvRuntimeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.error.SmvRuntimeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.RuntimeError</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-smv.functions">
<span id="smv-functions-module"></span><h2>smv.functions module<a class="headerlink" href="#module-smv.functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="smv.functions.diceSorensen">
<code class="descclassname">smv.functions.</code><code class="descname">diceSorensen</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#diceSorensen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.diceSorensen" title="Permalink to this definition">¶</a></dt>
<dd><p>2-gram UDF with formula (2 * number of overlaped gramCnt)/(s1.gramCnt + s2.gramCnt)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>c1 (Column): first column
c2 (Column): second column</dd>
<dt>Returns:</dt>
<dd>(Column): 2-gram</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.jaroWinkler">
<code class="descclassname">smv.functions.</code><code class="descname">jaroWinkler</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#jaroWinkler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.jaroWinkler" title="Permalink to this definition">¶</a></dt>
<dd><p>Jaro-Winkler edit distance metric UDF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>c1 (Column): first column
c2 (Column): second column</dd>
<dt>Returns:</dt>
<dd>(Column): distances</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.nGram2">
<code class="descclassname">smv.functions.</code><code class="descname">nGram2</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#nGram2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.nGram2" title="Permalink to this definition">¶</a></dt>
<dd><p>2-gram UDF with formula (number of overlaped gramCnt)/max(c1.gramCnt, c2.gramCnt)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>c1 (Column): first column
c2 (Column): second column</dd>
<dt>Returns:</dt>
<dd>(Column): 2-gram</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.nGram3">
<code class="descclassname">smv.functions.</code><code class="descname">nGram3</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#nGram3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.nGram3" title="Permalink to this definition">¶</a></dt>
<dd><p>3-gram UDF with formula (number of overlaped gramCnt)/max(s1.gramCnt, s2.gramCnt)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>c1 (Column): first column
c2 (Column): second column</dd>
<dt>Returns:</dt>
<dd>(Column): 3-gram</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.normlevenshtein">
<code class="descclassname">smv.functions.</code><code class="descname">normlevenshtein</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#normlevenshtein"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.normlevenshtein" title="Permalink to this definition">¶</a></dt>
<dd><p>Levenshtein edit distance metric UDF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>c1 (Column): first column
c2 (Column): second column</dd>
<dt>Returns:</dt>
<dd>(Column): distances</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvArrayCat">
<code class="descclassname">smv.functions.</code><code class="descname">smvArrayCat</code><span class="sig-paren">(</span><em>sep</em>, <em>col</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvArrayCat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvArrayCat" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array typed column, concat the elements to a string with the given separater.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>sep: a Python string to separate the fields
col: a Column with ArrayType</dd>
<dt>Return:</dt>
<dd>(col): a Column in StringType with array elements concatenated</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvCollectSet">
<code class="descclassname">smv.functions.</code><code class="descname">smvCollectSet</code><span class="sig-paren">(</span><em>col</em>, <em>datatype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvCollectSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvCollectSet" title="Permalink to this definition">¶</a></dt>
<dd><p>An aggregate function, which will collect all the values of the given column and create a set as an array typed column.
Since Spark 1.6, a spark function collect_set was introduced, so as migrate to Spark 1.6 and later, this smvCollectSet
will be depricated.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>col (Column): column to be aggregated on
datatype (DataType): datatype of the input column</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvCreateLookUp">
<code class="descclassname">smv.functions.</code><code class="descname">smvCreateLookUp</code><span class="sig-paren">(</span><em>m</em>, <em>default</em>, <em>outputType</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvCreateLookUp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvCreateLookUp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Python UDF which will perform a dictionary lookup on a column</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>m (dictionary): a Python dictionary to be applied
default (any): default value if dictionary lookup failed
outputType (DataType): output value’s data type</dd>
<dt>Returns:</dt>
<dd>(udf): an udf which can apply to a column and apply the lookup</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvFirst">
<code class="descclassname">smv.functions.</code><code class="descname">smvFirst</code><span class="sig-paren">(</span><em>c</em>, <em>nonNull=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvFirst"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvFirst" title="Permalink to this definition">¶</a></dt>
<dd><p>Variation of Spark “first” which also returns null values</p>
<p>Since Spark “first” will return the first non-null value, we have to
create our version smvFirst which to retune the real first value, even
if it’s null. Alternatively can return the first non-null value.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>c (Column: column to extract first value from
nonNull (bool): If false, return first value even if null. If true, return first non-null value. Defaults to false.</dd>
<dt>Returns:</dt>
<dd>(object): first value</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvHashKey">
<code class="descclassname">smv.functions.</code><code class="descname">smvHashKey</code><span class="sig-paren">(</span><em>head</em>, <em>*others</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvHashKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvHashKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Create MD5 on concatenated columns.
Return “Prefix” + MD5 Hex string(size 32 string) as the unique key</p>
<p>MD5’s collisions rate on real data records could be ignored based on the following discussion.</p>
<p><a class="reference external" href="https://marc-stevens.nl/research/md5-1block-collision/">https://marc-stevens.nl/research/md5-1block-collision/</a>
The shortest messages have the same MD5 are 512-bit (64-byte) messages as below</p>
<p>4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2
and the (different by two bits)
4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2
both have MD5 hash
008ee33a9d58b51cfeb425b0959121c9</p>
<p>There are other those pairs, but all carefully constructed.
Theoretically the random collisions will happen on data size approaching 2^64 (since MD5 has
128-bit), which is much larger than the number of records we deal with (a billion is about 2^30)
There for using MD5 to hash primary key columns is good enough for creating an unique key</p>
<p>This function can take 2 forms:
- smvHashKey(prefix, col1, col2, …)
- smvHashKey(col1, col2, …)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>prefix (String): return string’s prefix
col. (Column): columns to be part of hash</dd>
<dt>Return:</dt>
<dd>(col): a StringType column as Prefix + MD5 Hex string</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvStrCat">
<code class="descclassname">smv.functions.</code><code class="descname">smvStrCat</code><span class="sig-paren">(</span><em>head</em>, <em>*others</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvStrCat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvStrCat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate multiple columns to a single string. Similar to <cite>concat</cite> and <cite>concat_ws</cite> functions in Spark but behaves differently
when some columns are nulls.
The Spark version will return null if any of the inputs is null.
smvStrCat will return null if all of the inputs are nulls, otherwise it will coalesce null cols to blank.</p>
<p>This function can take 2 forms:
- smvStrCat(sep, col1, col2, …)
- smvStrCat(col1, col2, …)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>sep (String): separater for the concats
col. (Column): columns to be concatenated</dd>
<dt>Return:</dt>
<dd>(col): a StringType column</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-smv.graph">
<span id="smv-graph-module"></span><h2>smv.graph module<a class="headerlink" href="#module-smv.graph" title="Permalink to this headline">¶</a></h2>
<p>Provides dependency graphing of SMV modules.</p>
<dl class="class">
<dt id="smv.graph.SmvDependencyGraph">
<em class="property">class </em><code class="descclassname">smv.graph.</code><code class="descname">SmvDependencyGraph</code><span class="sig-paren">(</span><em>smvApp</em>, <em>stageNames=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/graph.html#SmvDependencyGraph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.graph.SmvDependencyGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">graphviz.files.Source</span></code></p>
</dd></dl>

<dl class="function">
<dt id="smv.graph.svg_graph">
<code class="descclassname">smv.graph.</code><code class="descname">svg_graph</code><span class="sig-paren">(</span><em>*stageNames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/graph.html#svg_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.graph.svg_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-smv.helpers">
<span id="smv-helpers-module"></span><h2>smv.helpers module<a class="headerlink" href="#module-smv.helpers" title="Permalink to this headline">¶</a></h2>
<p>SMV DataFrame Helpers and Column Helpers</p>
<p>This module provides the helper functions on DataFrame objects and Column objects</p>
<dl class="class">
<dt id="smv.helpers.ColumnHelper">
<em class="property">class </em><code class="descclassname">smv.helpers.</code><code class="descname">ColumnHelper</code><span class="sig-paren">(</span><em>col</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvDay70">
<code class="descname">smvDay70</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvDay70"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvDay70" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Timestamp to the number of days from 1970-01-01</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvDay70</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): IntegerType. Number of days from 1970-01-01 (start from 0)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvDayOfMonth">
<code class="descname">smvDayOfMonth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvDayOfMonth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvDayOfMonth" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract day of month component from a timestamp</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvDayOfMonth</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): IntegerType. Day of month component as integer (range 1-31), or null if input column is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvDayOfWeek">
<code class="descname">smvDayOfWeek</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvDayOfWeek"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvDayOfWeek" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract day of week component from a timestamp</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvDayOfWeek</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): IntegerType. Day of week component as integer (range 1-7, 1 being Sunday), or null if input column is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvGetColName">
<code class="descname">smvGetColName</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvGetColName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvGetColName" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of a Column as a sting</p>
<p>Example:
&gt;&gt;&gt; df.a.smvGetColName()</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(str)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvHour">
<code class="descname">smvHour</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvHour"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvHour" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract hour component from a timestamp</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvHour</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): IntegerType. Hour component as integer, or null if input column is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvIsAllIn">
<code class="descname">smvIsAllIn</code><span class="sig-paren">(</span><em>*vals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvIsAllIn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvIsAllIn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if ALL of the Array columns’ elements are in the given parameter sequence</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>vals (*any): vals must be of the same type as the Array content</dd>
<dt>Example:</dt>
<dd><p class="first">input DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">k</th>
<th class="head">v</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>b</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>d</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">smvIsAllIn</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;isFound&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>output DF:</p>
<blockquote class="last">
<div><table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">isFound</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>true</td>
</tr>
<tr class="row-odd"><td>false</td>
</tr>
<tr class="row-even"><td>false</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>(Column): BooleanType</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvIsAnyIn">
<code class="descname">smvIsAnyIn</code><span class="sig-paren">(</span><em>*vals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvIsAnyIn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvIsAnyIn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if ANY one of the Array columns’ elements are in the given parameter sequence</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>vals (*any): vals must be of the same type as the Array content</dd>
<dt>Example:</dt>
<dd><p class="first">input DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">k</th>
<th class="head">v</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>b</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>d</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">smvIsAnyIn</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;isFound&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>output DF:</p>
<blockquote class="last">
<div><table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">isFound</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>true</td>
</tr>
<tr class="row-odd"><td>true</td>
</tr>
<tr class="row-even"><td>false</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>(Column): BooleanType</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvMonth">
<code class="descname">smvMonth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvMonth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvMonth" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract month component from a timestamp</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvMonth</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): IntegerType. Month component as integer, or null if input column is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvMonth70">
<code class="descname">smvMonth70</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvMonth70"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvMonth70" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Timestamp to the number of months from 1970-01-01</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvMonth70</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): IntegerType. Number of months from 1970-01-01 (start from 0)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvPlusDays">
<code class="descname">smvPlusDays</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvPlusDays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvPlusDays" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N days to <cite>Timestamp</cite> column</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>delta (integer): the number of days to add</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPlusDays</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): TimestampType. The incremented Timestamp, or null if input is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvPlusMonths">
<code class="descname">smvPlusMonths</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvPlusMonths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvPlusMonths" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N months to <cite>Timestamp</cite> column</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>delta (integer): the number of months to add</dd>
<dt>Note:</dt>
<dd>The calculation will do its best to only change the month field retaining the same day of month. However, in certain circumstances, it may be necessary to alter smaller fields. For example, 2007-03-31 plus one month cannot result in 2007-04-31, so the day of month is adjusted to 2007-04-30.</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPlusMonths</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): TimestampType. The incremented Timestamp, or null if input is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvPlusWeeks">
<code class="descname">smvPlusWeeks</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvPlusWeeks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvPlusWeeks" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N weeks to <cite>Timestamp</cite> column</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>delta (integer): the number of weeks to add</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPlusWeeks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): TimestampType. The incremented Timestamp, or null if input is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvPlusYears">
<code class="descname">smvPlusYears</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvPlusYears"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvPlusYears" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N years to <cite>Timestamp</cite> column</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>delta (integer): the number of years to add</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPlusYears</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): TimestampType. The incremented Timestamp, or null if input is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvQuarter">
<code class="descname">smvQuarter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvQuarter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvQuarter" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract quarter component from a timestamp</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvQuarter</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): IntegerType. Quarter component as integer (1-based), or null if input column is null</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvStrToTimestamp">
<code class="descname">smvStrToTimestamp</code><span class="sig-paren">(</span><em>fmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvStrToTimestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvStrToTimestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a timestamp from a string</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>fmt (string): the format is the same as the Java <cite>Date</cite> format</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvStrToTimestamp</span><span class="p">(</span><span class="s2">&quot;yyyy-MM-dd&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): TimestampType. The converted Timestamp</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvYear">
<code class="descname">smvYear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvYear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvYear" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract year component from a timestamp</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvYear</span><span class="p">())</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(Column): IntegerType. Year component as integer, or null if input column is null</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.helpers.DataFrameHelper">
<em class="property">class </em><code class="descclassname">smv.helpers.</code><code class="descname">DataFrameHelper</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="smv.helpers.DataFrameHelper.peek">
<code class="descname">peek</code><span class="sig-paren">(</span><em>pos=1</em>, <em>colRegex=’.*’</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.peek"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.peek" title="Permalink to this definition">¶</a></dt>
<dd><p>Display a DataFrame row in transposed view</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>pos (integer): the n-th row to display, default as 1
colRegex (string): show the columns with name matching the regex, default as “.*”</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.peekSave">
<code class="descname">peekSave</code><span class="sig-paren">(</span><em>path</em>, <em>pos=1</em>, <em>colRegex=’.*’</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.peekSave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.peekSave" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <cite>peek</cite> result to a file</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (string): local file name to Write
pos (integer): the n-th row to display, default as 1
colRegex (string): show the columns with name matching the regex, default as “.*”</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvBinHist">
<code class="descname">smvBinHist</code><span class="sig-paren">(</span><em>*colWithBin</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvBinHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvBinHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Print distributions on numerical columns with applying the specified bin size</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>colWithBin (*tuple): each tuple must be of size 2, where the first element is the column name, and the second is the bin size for that column</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvBinHist</span><span class="p">((</span><span class="s2">&quot;col_a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvConcatHist">
<code class="descname">smvConcatHist</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvConcatHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvConcatHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Display EDD histogram of a group of columns (joint distribution)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string): The columns on which to perform EDD histogram</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvConcatHist</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvCountHist">
<code class="descname">smvCountHist</code><span class="sig-paren">(</span><em>keys</em>, <em>binSize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvCountHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvCountHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the distribution of the value frequency on specific columns</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>keys (list(string)): the column names on which the EDD histogram is performed
binSize (integer): the bin size for the histogram</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvCountHist</span><span class="p">([</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDedupByKey">
<code class="descname">smvDedupByKey</code><span class="sig-paren">(</span><em>*keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDedupByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDedupByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicate records from the DataFrame by arbitrarily selecting the first record from a set of records with same primary key or key combo.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>keys (*string or *Column): the column names or Columns on which to apply dedup</dd>
<dt>Example:</dt>
<dd><p class="first">input DataFrame:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>C1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>C</td>
<td>C2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>B</td>
<td>C4</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDedupByKey</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>output DataFrame:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>C1</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDedupByKey</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>output DataFrame:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>C1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>C</td>
<td>C2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
</tbody>
</table>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): a DataFrame without duplicates for the specified keys</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDedupByKeyWithOrder">
<code class="descname">smvDedupByKeyWithOrder</code><span class="sig-paren">(</span><em>*keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDedupByKeyWithOrder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDedupByKeyWithOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicated records by selecting the first record relative to a given ordering</p>
<p>The order is specified in another set of parentheses, as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">smvDedupByKeyWithOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">)(</span><span class="o">*</span><span class="n">orderCols</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Note:</dt>
<dd>Same as the <cite>smvDedupByKey</cite> method, we use RDD groupBy in the implementation of this method to make sure we can handle large key space.</dd>
<dt>Args:</dt>
<dd>keys (*string or *Column): the column names or Columns on which to apply dedup</dd>
<dt>Example:</dt>
<dd><p class="first">input DataFrame:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>C1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>C</td>
<td>C2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>B</td>
<td>C4</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDedupByKeyWithOrder</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;product&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
</pre></div>
</div>
<p>output DataFrame:</p>
<table border="1" class="last docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>C</td>
<td>C2</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
</tbody>
</table>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): a DataFrame without duplicates for the specified keys / order</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDesc">
<code class="descname">smvDesc</code><span class="sig-paren">(</span><em>*colDescs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDesc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDesc" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds column descriptions</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>colDescs (*tuple): tuples of strings where the first is the column name, and the second is the description to add</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDesc</span><span class="p">((</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;description of col a&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;description of col b&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the DataFrame with column descriptions added</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDescFromDF">
<code class="descname">smvDescFromDF</code><span class="sig-paren">(</span><em>descDF</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDescFromDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDescFromDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds column descriptions</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>descDF (DataFrame): a companion 2-column desciptionDF that has variable names as column 1 and corresponding variable descriptions as column 2</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDescFromDF</span><span class="p">(</span><span class="n">desciptionDF</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the DataFrame with column descriptions added</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDiscoverPK">
<code class="descname">smvDiscoverPK</code><span class="sig-paren">(</span><em>n=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDiscoverPK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDiscoverPK" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a column combination which uniquely identifies a row from the data</p>
<p>The resulting output is printed out</p>
<dl class="docutils">
<dt>Note:</dt>
<dd>The algorithm only looks for a set of keys which uniquely identifies the row. There could be more key combinations which can also be the primary key.</dd>
<dt>Args:</dt>
<dd>n (integer): number of rows the PK discovery algorithm will run on, defaults to 10000</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDiscoverPK</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDumpDF">
<code class="descname">smvDumpDF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDumpDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDumpDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump the schema and data of given df to screen for debugging purposes</p>
<p>Similar to <cite>show()</cite> method of DF from Spark 1.3, although the format is slightly different.  This function’s format is more convenient for us and hence has remained.</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDumpDF</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvEdd">
<code class="descname">smvEdd</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvEdd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvEdd" title="Permalink to this definition">¶</a></dt>
<dd><p>Display EDD summary</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string): column names on which to perform EDD summary</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvEdd</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvEddCompare">
<code class="descname">smvEddCompare</code><span class="sig-paren">(</span><em>df2</em>, <em>ignoreColName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvEddCompare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvEddCompare" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare 2 DFs by comparing their Edd Summary result</p>
<p>The result of the comparison is printed out.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>df2 (DataFrame): the DataFrame to compare with
ignoreColName (boolean): specifies whether to ignore column names, default is false</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvEddCompare</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvEddCompare</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvExpandStruct">
<code class="descname">smvExpandStruct</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvExpandStruct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvExpandStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand structure type column to a group of columns</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string): column names to expand</dd>
<dt>Example:</dt>
<dd><dl class="first docutils">
<dt>input DF:</dt>
<dd>[id: string, address: struct&lt;state:string, zip:string, street:string&gt;]</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvExpandStruct</span><span class="p">(</span><span class="s2">&quot;address&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="last docutils">
<dt>output DF:</dt>
<dd>[id: string, state: string, zip: string, street: string]</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): DF with expanded columns</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvExportCsv">
<code class="descname">smvExportCsv</code><span class="sig-paren">(</span><em>path</em>, <em>n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvExportCsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvExportCsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Export DataFrame to local file system</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (string): relative path to the app running directory on local file system (instead of HDFS)
n (integer): optional. number of records to export. default is all records</dd>
<dt>Note:</dt>
<dd>Since we have to collect the DF and then call JAVA file operations, the job have to be launched as either local or yar-client mode. Also it is user’s responsibility to make sure that the DF is small enough to fit into local file system.</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvExportCsv</span><span class="p">(</span><span class="s2">&quot;./target/python-test-export-csv.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvFreqHist">
<code class="descname">smvFreqHist</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvFreqHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvFreqHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Print EDD histogram with frequency sorting</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string): The columns on which to perform EDD histogram</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvFreqHist</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvGetDesc">
<code class="descname">smvGetDesc</code><span class="sig-paren">(</span><em>colName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvGetDesc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvGetDesc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns column description(s)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>colName (string): optional column name for which to get the description.</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGetDesc</span><span class="p">(</span><span class="s2">&quot;col_a&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGetDesc</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(string): description string of colName, if specified</dd>
</dl>
<p>or:</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(list(tuple)): a list of (colName, description) pairs for all columns</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvGroupBy">
<code class="descname">smvGroupBy</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvGroupBy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvGroupBy" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to groupBy, instead of creating GroupedData, create an <cite>SmvGroupedData</cite> object.</p>
<p>See [[org.tresamigos.smv.SmvGroupedDataFunc]] for list of functions that can be applied to the grouped data.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string or *Column): column names or Column objects to group on</dd>
<dt>Note:</dt>
<dd>This is going away shortly and user will be able to use standard Spark <cite>groupBy</cite> method directly.</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(SmvGroupedData): grouped data object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvHashSample">
<code class="descname">smvHashSample</code><span class="sig-paren">(</span><em>key</em>, <em>rate=0.01</em>, <em>seed=23</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvHashSample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvHashSample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample the df according to the hash of a column</p>
<p>MurmurHash3 algorithm is used for generating the hash</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>key (string or Column): column name or Column to sample on
rate (double): sample rate in range (0, 1] with a default of 0.01 (1%)
seed (int): random generator integer seed with a default of 23</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvHashSample</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">),</span> <span class="n">rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): sampled DF</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvHist">
<code class="descname">smvHist</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Display EDD histogram</p>
<p>Each column’s histogram prints separately</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string): The columns on which to perform EDD histogram</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvHist</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvJoinByKey">
<code class="descname">smvJoinByKey</code><span class="sig-paren">(</span><em>other</em>, <em>keys</em>, <em>joinType</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvJoinByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvJoinByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>joins two DataFrames on a key</p>
<p>The Spark <cite>DataFrame</cite> join operation does not handle duplicate key names.
If both left and right side of the join operation contain the same key,
the result <cite>DataFrame</cite> is unusable.</p>
<p>The <cite>smvJoinByKey</cite> method will allow the user to join two <cite>DataFrames</cite> using the same join key.
Post join, only the left side keys will remain. In case of outer-join, the
<cite>coalesce(leftkey, rightkey)</cite> will replace the left key to be kept.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>other (DataFrame): the DataFrame to join with
keys (list(string)): a list of column names on which to apply the join
joinType (string): choose one of [‘inner’, ‘outer’, ‘leftouter’, ‘rightouter’, ‘leftsemi’]</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">smvJoinByKey</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="s2">&quot;inner&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): result of the join operation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvJoinMultipleByKey">
<code class="descname">smvJoinMultipleByKey</code><span class="sig-paren">(</span><em>keys</em>, <em>joinType=’inner’</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvJoinMultipleByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvJoinMultipleByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Create multiple DF join builder</p>
<p>It is used in conjunction with <cite>joinWith</cite> and <cite>doJoin</cite></p>
<dl class="docutils">
<dt>Args:</dt>
<dd>keys (list(string)): a list of column names on which to apply the join
joinType (string): choose one of [‘inner’, ‘outer’, ‘leftouter’, ‘rightouter’, ‘leftsemi’]</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">joinMultipleByKey</span><span class="p">([</span><span class="s2">&quot;k1&quot;</span><span class="p">,</span> <span class="s2">&quot;k2&quot;</span><span class="p">],</span> <span class="s2">&quot;inner&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">joinWith</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s2">&quot;_df2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">joinWith</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="s2">&quot;_df3&quot;</span><span class="p">,</span> <span class="s2">&quot;leftouter&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">doJoin</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(SmvMultiJoin): the builder object for the multi join operation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvOverlapCheck">
<code class="descname">smvOverlapCheck</code><span class="sig-paren">(</span><em>keyColName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvOverlapCheck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvOverlapCheck" title="Permalink to this definition">¶</a></dt>
<dd><p>For a set of DFs, which share the same key column, check the overlap across them</p>
<p>The other DataFrames are specified in another set of parentheses, as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">smvOverlapCheck</span><span class="p">(</span><span class="n">key</span><span class="p">)(</span><span class="o">*</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Args:</dt>
<dd>keyColName (string): the column name for the key column</dd>
<dt>Examples:</dt>
<dd><div class="first highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">smvOverlapCheck</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)(</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">,</span> <span class="n">df4</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>output DF has 2 columns:</dt>
<dd><ul class="first last simple">
<li>key</li>
<li>flag: a bit-string, e.g. 0110. Each bit represents whether the original DF has this key</li>
</ul>
</dd>
</dl>
<p>It can be used with EDD to summarize on the flag:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">smvOverlapCheck</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)(</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">smvHist</span><span class="p">(</span><span class="s2">&quot;flag&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the DataFrame with the key and flag columns</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvPrefixFieldNames">
<code class="descname">smvPrefixFieldNames</code><span class="sig-paren">(</span><em>prefix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvPrefixFieldNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvPrefixFieldNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a prefix to all column names in the given <cite>DataFrame</cite>.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>prefix (string): prefix string to be added to all the column names</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvPrefixFieldNames</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>Above will add <cite>x_</cite> to the beginning of every column name in the <cite>DataFrame</cite>.
Please note that if the renamed column names over lap with existing columns,
the method will error out.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(DataFrame)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvRemoveDesc">
<code class="descname">smvRemoveDesc</code><span class="sig-paren">(</span><em>*colNames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvRemoveDesc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvRemoveDesc" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes description for the given columns from the Dataframe</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>colNames (*string): names of columns for which to remove the description</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvRemoveDesc</span><span class="p">(</span><span class="s2">&quot;col_a&quot;</span><span class="p">,</span> <span class="s2">&quot;col_b&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the DataFrame with column descriptions removed</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvRenameField">
<code class="descname">smvRenameField</code><span class="sig-paren">(</span><em>*namePairs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvRenameField"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvRenameField" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename one or more fields of a <cite>DataFrame</cite></p>
<dl class="docutils">
<dt>Args:</dt>
<dd>namePairs (*tuple): tuples of strings where the first is the source column name, and the second is the target column name</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvRenameField</span><span class="p">((</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;aa&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;cc&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the DataFrame with renamed fields</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvSelectMinus">
<code class="descname">smvSelectMinus</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvSelectMinus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvSelectMinus" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove one or more columns from current DataFrame</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string or *Column): column names or Columns to remove from the DataFrame</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvSelectMinus</span><span class="p">(</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvSelectMinus</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;col1&quot;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;col2&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the resulting DataFrame after removal of columns</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvSelectPlus">
<code class="descname">smvSelectPlus</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvSelectPlus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvSelectPlus" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects all the current columns in current DataFrame plus the supplied expressions</p>
<p>The new columns are added to the end of the current column list.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*Column): expressions to add to the DataFrame</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvSelectPlus</span><span class="p">((</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;amt&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the resulting DataFrame after removal of columns</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvSkewJoinByKey">
<code class="descname">smvSkewJoinByKey</code><span class="sig-paren">(</span><em>other</em>, <em>joinType</em>, <em>skewVals</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvSkewJoinByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvSkewJoinByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Join that leverages broadcast (map-side) join of rows with skewed (high-frequency) values</p>
<p>Rows keyed by skewed values are joined via broadcast join while remaining
rows are joined without broadcast join. Occurrences of skewVals in df2 should be
infrequent enough that the filtered table is small enough for a broadcast join.
result is the union of the join results.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>other (DataFrame): DataFrame to join with
joinType (str): name of type of join (e.g. “inner”)
skewVals (list(object)): list of skewed values
key (str): key on which to join (also the Column with the skewed values)</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvSkewJoinByKey</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;cid&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>will broadcast join the rows of df1 and df2 where col(“cid”) == “4”
and join the remaining rows of df1 and df2 without broadcast join.</p>
</div></blockquote>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(DataFrame): the result of the join operation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvUnion">
<code class="descname">smvUnion</code><span class="sig-paren">(</span><em>*dfothers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvUnion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvUnion" title="Permalink to this definition">¶</a></dt>
<dd><p>Unions DataFrames with different number of columns by column name and schema</p>
<p>Spark unionAll ignores column names &amp; schema, and can only be performed on tables with the same number of columns.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>dfOthers (*DataFrame): the dataframes to union with</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvUnion</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the union of all specified DataFrames</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvUnpivot">
<code class="descname">smvUnpivot</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvUnpivot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvUnpivot" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpivot the selected columns</p>
<p>Given a set of records with value columns, turns the value columns into value rows.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string): the names of the columns to unpivot</dd>
<dt>Example:</dt>
<dd><p class="first">input DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">X</th>
<th class="head">Y</th>
<th class="head">Z</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>B</td>
<td>C</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>D</td>
<td>E</td>
<td>F</td>
</tr>
<tr class="row-even"><td>3</td>
<td>G</td>
<td>H</td>
<td>I</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvUnpivot</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>output DF:</p>
<blockquote class="last">
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="42%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">column</th>
<th class="head">value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>X</td>
<td>A</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>Y</td>
<td>B</td>
</tr>
<tr class="row-even"><td>1</td>
<td>Z</td>
<td>C</td>
</tr>
<tr class="row-odd"><td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="row-even"><td>3</td>
<td>Y</td>
<td>H</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>Z</td>
<td>I</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the unpivoted DataFrame</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvUnpivotRegex">
<code class="descname">smvUnpivotRegex</code><span class="sig-paren">(</span><em>cols</em>, <em>colNameFn</em>, <em>indexColName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvUnpivotRegex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvUnpivotRegex" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpivot the selected columns using the specified regex</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>cols (*string): the names of the columns to unpivot
colNameFn (string): a regex representing the function to be applied when unpivoting
indexColName (string): the name of the index column to be created</dd>
<dt>Example:</dt>
<dd><p class="first">input DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">A_1</th>
<th class="head">A_2</th>
<th class="head">B_1</th>
<th class="head">B_2</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>1_a_1</td>
<td>1_a_2</td>
<td>1_b_1</td>
<td>1_b_2</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>2_a_1</td>
<td>2_a_2</td>
<td>2_b_1</td>
<td>2_b_2</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvUnpivotRegex</span><span class="p">(</span> <span class="p">[</span><span class="s2">&quot;A_1&quot;</span><span class="p">,</span> <span class="s2">&quot;A_2&quot;</span><span class="p">,</span> <span class="s2">&quot;B_1&quot;</span><span class="p">,</span> <span class="s2">&quot;B_2&quot;</span><span class="p">],</span> <span class="s2">&quot;(.*)_(.*)&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>output DF:</p>
<blockquote class="last">
<div><table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="28%" />
<col width="28%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">index</th>
<th class="head">A</th>
<th class="head">B</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>1</td>
<td>1_a_1</td>
<td>1_b_1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>2</td>
<td>1_a_2</td>
<td>1_b_2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>1</td>
<td>2_a_1</td>
<td>2_b_1</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>2</td>
<td>2_a_2</td>
<td>2_b_2</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): the unpivoted DataFrame</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.topNValsByFreq">
<code class="descname">topNValsByFreq</code><span class="sig-paren">(</span><em>n</em>, <em>col</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.topNValsByFreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.topNValsByFreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Get top N most frequent values in Column col</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>n (int): maximum number of values
col (Column): which column to get values from</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">topNValsByFreq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;cid&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>will return the single most frequent value in the cid column</p>
</div></blockquote>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(list(object)): most frequent values (type depends on schema)</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.helpers.SmvGroupedData">
<em class="property">class </em><code class="descclassname">smv.helpers.</code><code class="descname">SmvGroupedData</code><span class="sig-paren">(</span><em>df</em>, <em>keys</em>, <em>sgd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The result of running <cite>smvGroupBy</cite> on a DataFrame. Implements special SMV aggregations.</p>
<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvFillNullWithPrevValue">
<code class="descname">smvFillNullWithPrevValue</code><span class="sig-paren">(</span><em>*orderCols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvFillNullWithPrevValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvFillNullWithPrevValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill in Null values with “previous” value according to an ordering</p>
<dl class="docutils">
<dt>Examples:</dt>
<dd><p class="first">Given DataFrame df representing the table</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">K</th>
<th class="head">T</th>
<th class="head">V</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>1</td>
<td>null</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>2</td>
<td>a</td>
</tr>
<tr class="row-even"><td>a</td>
<td>3</td>
<td>b</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>4</td>
<td>null</td>
</tr>
</tbody>
</table>
<p>we can use</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&gt;&gt;&gt; df.smvGroupBy(&quot;K&quot;).smvFillNullWithPrevValue($&quot;T&quot;.asc)(&quot;V&quot;)
</pre></div>
</div>
<p>to produce the result</p>
<table border="1" class="last docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">K</th>
<th class="head">T</th>
<th class="head">V</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>1</td>
<td>null</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>2</td>
<td>a</td>
</tr>
<tr class="row-even"><td>a</td>
<td>3</td>
<td>b</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>4</td>
<td>b</td>
</tr>
</tbody>
</table>
</dd>
<dt>Returns:</dt>
<dd>(Dataframe): result of fill nulls with previous value</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvPivot">
<code class="descname">smvPivot</code><span class="sig-paren">(</span><em>pivotCols</em>, <em>valueCols</em>, <em>baseOutput</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvPivot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvPivot" title="Permalink to this definition">¶</a></dt>
<dd><p>smvPivot adds the pivoted columns without additional aggregation. In other words
N records in, N records out</p>
<p>SmvPivot for Pivot Operations:</p>
<p>Pivot Operation on DataFrame that transforms multiple rows per key into a columns so
they can be aggregated to a single row for a given key while preserving all the data
variance.</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><p class="first">For input data below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="25%" />
<col width="32%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">month</th>
<th class="head">product</th>
<th class="head">count</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>5/14</td>
<td>A</td>
<td>100</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>6/14</td>
<td>B</td>
<td>200</td>
</tr>
<tr class="row-even"><td>1</td>
<td>5/14</td>
<td>B</td>
<td>300</td>
</tr>
</tbody>
</table>
<p>We would like to generate a data set to be ready for aggregations.
The desired output is:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">count_5_14_A</th>
<th class="head">count_5_14_B</th>
<th class="head">count_6_14_A</th>
<th class="head">count_6_14_B</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>100</td>
<td>NULL</td>
<td>NULL</td>
<td>NULL</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>NULL</td>
<td>NULL</td>
<td>NULL</td>
<td>200</td>
</tr>
<tr class="row-even"><td>1</td>
<td>NULL</td>
<td>300</td>
<td>NULL</td>
<td>NULL</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>The raw input is divided into three parts.</dt>
<dd><ol class="first last arabic simple">
<li><dl class="first docutils">
<dt>key column: part of the primary key that is preserved in the output.</dt>
<dd>That would be the <cite>id</cite> column in the above example.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>pivot columns: the columns whose row values will become the new column names.</dt>
<dd>The cross product of all unique values for <em>each</em> column is used to generate
the output column names.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>value column: the value that will be copied/aggregated to corresponding output</dt>
<dd>column. <cite>count</cite> in our example.</dd>
</dl>
</li>
</ol>
</dd>
</dl>
<p>Example code:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPivot</span><span class="p">([[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;5_14_A&quot;</span><span class="p">,</span> <span class="s2">&quot;5_14_B&quot;</span><span class="p">,</span> <span class="s2">&quot;6_14_A&quot;</span><span class="p">,</span> <span class="s2">&quot;6_14_B&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd>
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>pivotCols (list(list(str))): specify the pivot columns, on above example, it is</dt>
<dd>[[‘month, ‘product]]. If [[‘month’], [‘month’, ‘product’]] is
used, the output columns will have “count_5_14” and “count_6_14” as
addition to the example.</dd>
<dt>valueCols (list(string)): names of value columns which will be prepared for</dt>
<dd>aggregation</dd>
<dt>baseOutput (list(str)): expected names of the pivoted column</dt>
<dd>In above example, it is [“5_14_A”, “5_14_B”, “6_14_A”, “6_14_B”].
The user is required to supply the list of expected pivot column output names to avoid
and extra action on the input DataFrame just to extract the possible pivot columns.
If an empty sequence is provided, the base output columns will be extracted from
values in the pivot columns (will cause an action on the entire DataFrame!)</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): result of pivot operation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvPivotCoalesce">
<code class="descname">smvPivotCoalesce</code><span class="sig-paren">(</span><em>pivotCols</em>, <em>valueCols</em>, <em>baseOutput</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvPivotCoalesce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvPivotCoalesce" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform SmvPivot, then coalesce the output
Please refer smvPivot’s document for context and details of the SmvPivot operation.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>pivotCols (list(list(str))): list of lists of column names to pivot
valueCols (list(string)): names of value columns to coalesce
baseOutput (list(str)): expected names pivoted column</dd>
<dt>Examples:</dt>
<dd><p class="first">For example, given a DataFrame df that represents the table</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="30%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">k</th>
<th class="head">p</th>
<th class="head">v</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>c</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>d</td>
<td>2</td>
</tr>
<tr class="row-even"><td>a</td>
<td>e</td>
<td>null</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>f</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>we can use</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPivotCoalesce</span><span class="p">([[</span><span class="s1">&#39;p&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>to produce the following output</p>
<table border="1" class="last docutils">
<colgroup>
<col width="19%" />
<col width="19%" />
<col width="19%" />
<col width="25%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">k</th>
<th class="head">v_c</th>
<th class="head">v_d</th>
<th class="head">v_e</th>
<th class="head">v_f</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>1</td>
<td>2</td>
<td>null</td>
<td>5</td>
</tr>
</tbody>
</table>
</dd>
<dt>Returns:</dt>
<dd>(Dataframe): result of pivot coalesce</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvPivotSum">
<code class="descname">smvPivotSum</code><span class="sig-paren">(</span><em>pivotCols</em>, <em>valueCols</em>, <em>baseOutput</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvPivotSum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvPivotSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform SmvPivot, then sum the results.
Please refer smvPivot’s document for context and details of the SmvPivot operation.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>pivotCols (list(list(str))): list of lists of column names to pivot
valueCols (list(string)): names of value columns to sum
baseOutput (list(str)): expected names pivoted column</dd>
<dt>Examples:</dt>
<dd><p class="first">For example, given a DataFrame df that represents the table</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="25%" />
<col width="32%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">month</th>
<th class="head">product</th>
<th class="head">count</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>5/14</td>
<td>A</td>
<td>100</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>6/14</td>
<td>B</td>
<td>200</td>
</tr>
<tr class="row-even"><td>1</td>
<td>5/14</td>
<td>B</td>
<td>300</td>
</tr>
</tbody>
</table>
<p>we can use</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPivotSum</span><span class="p">([[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;5_14_A&quot;</span><span class="p">,</span> <span class="s2">&quot;5_14_B&quot;</span><span class="p">,</span> <span class="s2">&quot;6_14_A&quot;</span><span class="p">,</span> <span class="s2">&quot;6_14_B&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>to produce the following output</p>
<table border="1" class="last docutils">
<colgroup>
<col width="8%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">count_5_14_A</th>
<th class="head">count_5_14_B</th>
<th class="head">count_6_14_A</th>
<th class="head">count_6_14_B</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>100</td>
<td>300</td>
<td>NULL</td>
<td>200</td>
</tr>
</tbody>
</table>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): result of pivot sum</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvTopNRecs">
<code class="descname">smvTopNRecs</code><span class="sig-paren">(</span><em>maxElems</em>, <em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvTopNRecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvTopNRecs" title="Permalink to this definition">¶</a></dt>
<dd><p>For each group, return the top N records according to a given ordering</p>
<p>Example:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvTopNRecs</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;amt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
</pre></div>
</div>
<p>This will keep the 3 largest amt records for each id</p>
</div></blockquote>
<dl class="docutils">
<dt>Args:</dt>
<dd>maxElems (int): maximum number of records per group
cols (*str): columns defining the ordering</dd>
<dt>Returns:</dt>
<dd>(DataFrame): result of taking top records from groups</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.helpers.SmvMultiJoin">
<em class="property">class </em><code class="descclassname">smv.helpers.</code><code class="descname">SmvMultiJoin</code><span class="sig-paren">(</span><em>sqlContext</em>, <em>mj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvMultiJoin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvMultiJoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wrapper around Scala’s SmvMultiJoin</p>
<dl class="method">
<dt id="smv.helpers.SmvMultiJoin.doJoin">
<code class="descname">doJoin</code><span class="sig-paren">(</span><em>dropextra=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvMultiJoin.doJoin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvMultiJoin.doJoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Trigger the join operation</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>dropExtra (boolean): default false, which will keep all duplicated name columns with the postfix.</dt>
<dd>when true, the duplicated columns will be dropped</dd>
</dl>
</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">joindf</span><span class="o">.</span><span class="n">doJoin</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): result of executing the join operation</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvMultiJoin.joinWith">
<code class="descname">joinWith</code><span class="sig-paren">(</span><em>df</em>, <em>postfix</em>, <em>jointype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvMultiJoin.joinWith"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvMultiJoin.joinWith" title="Permalink to this definition">¶</a></dt>
<dd><p>Append SmvMultiJoin Chain</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>df (DataFrame): the DataFrame to join with
postfix (string): postfix to use when renaming join columns
jointype (string): optional jointype. if not specified, <cite>conf.defaultJoinType</cite> is used.  choose one of [‘inner’, ‘outer’, ‘leftouter’, ‘rightouter’, ‘leftsemi’]</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">joindf</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">smvJoinMultipleByKey</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="s1">&#39;inner&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">joinWith</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s1">&#39;_df2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">joinWith</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="s1">&#39;_df3&#39;</span><span class="p">,</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(SmvMultiJoin): formula of the join. need to call <cite>doJoin()</cite> on it to execute</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-smv.matcher">
<span id="smv-matcher-module"></span><h2>smv.matcher module<a class="headerlink" href="#module-smv.matcher" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="smv.matcher.ExactLogic">
<code class="descclassname">smv.matcher.</code><code class="descname">ExactLogic</code><span class="sig-paren">(</span><em>colName</em>, <em>expr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#ExactLogic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.ExactLogic" title="Permalink to this definition">¶</a></dt>
<dd><p>Level match with exact logic</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>colName (string): level name used in the output DF
expr (Column): match logic colName</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ExactLogic</span><span class="p">(</span><span class="s2">&quot;First_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(ExactLogic)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.ExactMatchPreFilter">
<code class="descclassname">smv.matcher.</code><code class="descname">ExactMatchPreFilter</code><span class="sig-paren">(</span><em>colName</em>, <em>expr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#ExactMatchPreFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.ExactMatchPreFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify the top-level exact match</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>colName (string): level name used in the output DF
expr (Column): match logic condition Column</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ExactMatchPreFilter</span><span class="p">(</span><span class="s2">&quot;Full_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_full_name&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(ExactMatchPreFilter)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.FuzzyLogic">
<code class="descclassname">smv.matcher.</code><code class="descname">FuzzyLogic</code><span class="sig-paren">(</span><em>colName</em>, <em>predicate</em>, <em>valueExpr</em>, <em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#FuzzyLogic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.FuzzyLogic" title="Permalink to this definition">¶</a></dt>
<dd><p>Level match with fuzzy logic</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>colName (string): level name used in the output DF
predicate (Column): a condition column, no match if this condition evaluates as false
valueExpr (Column): a value column, which typically return a score. Higher score means higher chance of matching
threshold (float): No match if the evaluated <cite>valueExpr</cite> &lt; threshold</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FuzzyLogic</span><span class="p">(</span><span class="s2">&quot;Levenshtein_City&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">normlevenshtein</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">),</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_city&quot;</span><span class="p">)),</span> <span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(FuzzyLogic)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.GroupCondition">
<code class="descclassname">smv.matcher.</code><code class="descname">GroupCondition</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#GroupCondition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.GroupCondition" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify the shared matching condition of all the levels (except the top-level exact match)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>expr (Column): shared matching condition</dd>
<dt>Note:</dt>
<dd><cite>expr</cite> should be in “left == right” form so that it can really optimize the process by reducing searching space</dd>
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">GroupCondition</span><span class="p">(</span><span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(GroupCondition)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.NoOpGroupCondition">
<code class="descclassname">smv.matcher.</code><code class="descname">NoOpGroupCondition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#NoOpGroupCondition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.NoOpGroupCondition" title="Permalink to this definition">¶</a></dt>
<dd><p>Always returns None</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.NoOpPreFilter">
<code class="descclassname">smv.matcher.</code><code class="descname">NoOpPreFilter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#NoOpPreFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.NoOpPreFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Always returns None</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(None)</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="smv.matcher.SmvEntityMatcher">
<em class="property">class </em><code class="descclassname">smv.matcher.</code><code class="descname">SmvEntityMatcher</code><span class="sig-paren">(</span><em>leftId</em>, <em>rightId</em>, <em>exactMatchFilter</em>, <em>groupCondition</em>, <em>levelLogics</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#SmvEntityMatcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.SmvEntityMatcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Perform multiple level entity matching with exact and/or fuzzy logic</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>leftId (string): id column name of left DF (df1)
rightId (string): id column name of right DF (df2)
exactMatchFilter (ExactMatchPreFilter): exact match condition, if records matched no further tests will be performed
groupCondition (GroupCondition): for exact match leftovers, a deterministic condition to narrow down the search space
levelLogics (list(ExactLogic or FuzzyLogic)): A list of level match conditions (always weaker than exactMatchFilter), all of them will be tested</dd>
<dt>Example:</dt>
<dd><p class="first">code:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">SmvEntityMatcher</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
    <span class="n">ExactMatchPreFilter</span><span class="p">(</span><span class="s2">&quot;Full_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_full_name&quot;</span><span class="p">)),</span>
    <span class="n">GroupCondition</span><span class="p">(</span><span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">)),</span>
    <span class="p">[</span>
        <span class="n">ExactLogic</span><span class="p">(</span><span class="s2">&quot;First_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">)),</span>
        <span class="n">FuzzyLogic</span><span class="p">(</span><span class="s2">&quot;Levenshtein_City&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">normlevenshtein</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">),</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_city&quot;</span><span class="p">)),</span> <span class="mf">0.9</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="smv.matcher.SmvEntityMatcher.doMatch">
<code class="descname">doMatch</code><span class="sig-paren">(</span><em>df1</em>, <em>df2</em>, <em>keepOriginalCols=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#SmvEntityMatcher.doMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.SmvEntityMatcher.doMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <cite>SmvEntityMatcher</cite> to the 2 DataFrames</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>df1 (DataFrame): DataFrame 1 with an id column with name “id”
df2 (DataFrame): DataFrame 2 with an id column with name “id”
keepOriginalCols (boolean): whether to keep all input columns of df1 and df2, defaults to true</dd>
<dt>Example:</dt>
<dd><p class="first">code:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">SmvEntityMatcher</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
    <span class="n">ExactMatchPreFilter</span><span class="p">(</span><span class="s2">&quot;Full_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_full_name&quot;</span><span class="p">)),</span>
    <span class="n">GroupCondition</span><span class="p">(</span><span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">)),</span>
    <span class="p">[</span>
        <span class="n">ExactLogic</span><span class="p">(</span><span class="s2">&quot;First_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">)),</span>
        <span class="n">FuzzyLogic</span><span class="p">(</span><span class="s2">&quot;Levenshtein_City&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">normlevenshtein</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">),</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_city&quot;</span><span class="p">)),</span> <span class="mf">0.9</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">doMatch</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Returns:</dt>
<dd>(DataFrame): a DataFrame with df1’s id and df2’s id and match flags of all the levels. For levels with fuzzy logic, the matching score is also provided. A column named “MatchBitmap” also provided to summarize all the matching flags. When keepOriginalCols is true, input columns are also kept</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-smv.runconfig">
<span id="smv-runconfig-module"></span><h2>smv.runconfig module<a class="headerlink" href="#module-smv.runconfig" title="Permalink to this headline">¶</a></h2>
<p>SMV User Run Configuration Parameters</p>
<p>This module defined the SmvRunConfig class which can be mixed-in into an
SmvModule to get user configuration parameters at run-time.</p>
<dl class="class">
<dt id="smv.runconfig.SmvRunConfig">
<em class="property">class </em><code class="descclassname">smv.runconfig.</code><code class="descname">SmvRunConfig</code><a class="reference internal" href="_modules/smv/runconfig.html#SmvRunConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.runconfig.SmvRunConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Mix-in class to SmvModules that enable the module to access user run
configuration parameters at run time.</p>
<dl class="method">
<dt id="smv.runconfig.SmvRunConfig.smvGetRunConfig">
<code class="descname">smvGetRunConfig</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/runconfig.html#SmvRunConfig.smvGetRunConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.runconfig.SmvRunConfig.smvGetRunConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>return the current user run configuration value for the given key.</p>
</dd></dl>

<dl class="method">
<dt id="smv.runconfig.SmvRunConfig.smvGetRunConfigAsBool">
<code class="descname">smvGetRunConfigAsBool</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/runconfig.html#SmvRunConfig.smvGetRunConfigAsBool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.runconfig.SmvRunConfig.smvGetRunConfigAsBool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.runconfig.SmvRunConfig.smvGetRunConfigAsInt">
<code class="descname">smvGetRunConfigAsInt</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/runconfig.html#SmvRunConfig.smvGetRunConfigAsInt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.runconfig.SmvRunConfig.smvGetRunConfigAsInt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-smv.smvapp">
<span id="smv-smvapp-module"></span><h2>smv.smvapp module<a class="headerlink" href="#module-smv.smvapp" title="Permalink to this headline">¶</a></h2>
<p>SmvApp entry class
This module provides the main SMV Python entry point <code class="docutils literal"><span class="pre">SmvPy</span></code> class and a singleton <cite>smvApp</cite>.
It is equivalent to <code class="docutils literal"><span class="pre">SmvApp</span></code> on Scala side</p>
<dl class="class">
<dt id="smv.smvapp.SmvApp">
<em class="property">class </em><code class="descclassname">smv.smvapp.</code><code class="descname">SmvApp</code><span class="sig-paren">(</span><em>arglist</em>, <em>_sc=None</em>, <em>_sqlContext=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The Python representation of SMV.</p>
<p>Its singleton instance is created later in the containing module
and is named smvApp</p>
<p>Adds <cite>java_imports</cite> to the namespace in the JVM gateway in
SparkContext (in pyspark).  It also creates an instance of
SmvPyClient.</p>
<dl class="method">
<dt id="smv.smvapp.SmvApp.appName">
<code class="descname">appName</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.appName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.appName" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.createDF">
<code class="descname">createDF</code><span class="sig-paren">(</span><em>schema</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.createDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.createDF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="smv.smvapp.SmvApp.createInstance">
<em class="property">classmethod </em><code class="descname">createInstance</code><span class="sig-paren">(</span><em>arglist</em>, <em>_sc=None</em>, <em>_sqlContext=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.createInstance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.createInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>Create singleton instance. Also returns the instance.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.create_smv_pyclient">
<code class="descname">create_smv_pyclient</code><span class="sig-paren">(</span><em>arglist</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.create_smv_pyclient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.create_smv_pyclient" title="Permalink to this definition">¶</a></dt>
<dd><p>return a smvPyClient instance</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.defaultCsvWithHeader">
<code class="descname">defaultCsvWithHeader</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.defaultCsvWithHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.defaultCsvWithHeader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.defaultTsv">
<code class="descname">defaultTsv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.defaultTsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.defaultTsv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.defaultTsvWithHeader">
<code class="descname">defaultTsvWithHeader</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.defaultTsvWithHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.defaultTsvWithHeader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="smv.smvapp.SmvApp.getInstance">
<em class="property">classmethod </em><code class="descname">getInstance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getInstance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getInstance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.get_graph_json">
<code class="descname">get_graph_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.get_graph_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.get_graph_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a json string representing the dependency graph.
TODO: need to add a stageName parameter to limit it to a single stage.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.outputDir">
<code class="descname">outputDir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.outputDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.outputDir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.prepend_source">
<code class="descname">prepend_source</code><span class="sig-paren">(</span><em>source_dir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.prepend_source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.prepend_source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.runModule">
<code class="descname">runModule</code><span class="sig-paren">(</span><em>urn</em>, <em>forceRun=False</em>, <em>version=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.runModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.runModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs either a Scala or a Python SmvModule by its Fully Qualified Name(fqn)</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.runModuleByName">
<code class="descname">runModuleByName</code><span class="sig-paren">(</span><em>name</em>, <em>forceRun=False</em>, <em>version=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.runModuleByName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.runModuleByName" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.scalaOption">
<code class="descname">scalaOption</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.scalaOption"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.scalaOption" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Scala Option containing the value</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.urn2fqn">
<code class="descname">urn2fqn</code><span class="sig-paren">(</span><em>urnOrFqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.urn2fqn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.urn2fqn" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the SMV module FQN portion from its URN; if it’s already an FQN return it unchanged</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-smv.smvdataset">
<span id="smv-smvdataset-module"></span><h2>smv.smvdataset module<a class="headerlink" href="#module-smv.smvdataset" title="Permalink to this headline">¶</a></h2>
<p>SMV DataSet Framework interface</p>
<p>This module defines the abstract classes which formed the SmvDataSet Framework for clients’ projects</p>
<dl class="class">
<dt id="smv.smvdataset.SmvCsvFile">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvCsvFile</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvCsvFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvCsvFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.smvdataset.WithParser" title="smv.smvdataset.WithParser"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.WithParser</span></code></a>, <a class="reference internal" href="#smv.smvdataset.SmvInput" title="smv.smvdataset.SmvInput"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.SmvInput</span></code></a></p>
<p>Input from a file in CSV format</p>
<dl class="method">
<dt id="smv.smvdataset.SmvCsvFile.description">
<code class="descname">description</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvCsvFile.description"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvCsvFile.description" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvCsvFile.doRun">
<code class="descname">doRun</code><span class="sig-paren">(</span><em>validator</em>, <em>known</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvCsvFile.doRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvCsvFile.doRun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvCsvFile.getRawScalaInputDS">
<code class="descname">getRawScalaInputDS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvCsvFile.getRawScalaInputDS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvCsvFile.getRawScalaInputDS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="smv.smvdataset.SmvCsvFile.path">
<code class="descname">path</code><a class="headerlink" href="#smv.smvdataset.SmvCsvFile.path" title="Permalink to this definition">¶</a></dt>
<dd><p>User-specified path to the input csv file</p>
<p>Override this to specify the path to the csv file.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(str): path</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvCsvStringData">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvCsvStringData</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvCsvStringData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvCsvStringData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.smvdataset.SmvInput" title="smv.smvdataset.SmvInput"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.SmvInput</span></code></a></p>
<p>Input data defined by a schema string and data string</p>
<dl class="attribute">
<dt id="smv.smvdataset.SmvCsvStringData.dataStr">
<code class="descname">dataStr</code><a class="headerlink" href="#smv.smvdataset.SmvCsvStringData.dataStr" title="Permalink to this definition">¶</a></dt>
<dd><p>Smv data string.</p>
<p>E.g. “212,2016-10-03;119,2015-01-07”</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(str): data</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvCsvStringData.doRun">
<code class="descname">doRun</code><span class="sig-paren">(</span><em>validator</em>, <em>known</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvCsvStringData.doRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvCsvStringData.doRun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="smv.smvdataset.SmvCsvStringData.schemaStr">
<code class="descname">schemaStr</code><a class="headerlink" href="#smv.smvdataset.SmvCsvStringData.schemaStr" title="Permalink to this definition">¶</a></dt>
<dd><p>Smv Schema string.</p>
<p>E.g. “id:String; dt:Timestamp”</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(str): schema</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvDataSet">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvDataSet</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Abstract base class for all SmvDataSets</p>
<dl class="attribute">
<dt id="smv.smvdataset.SmvDataSet.IsSmvDataSet">
<code class="descname">IsSmvDataSet</code><em class="property"> = True</em><a class="headerlink" href="#smv.smvdataset.SmvDataSet.IsSmvDataSet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvDataSet.Java">
<em class="property">class </em><code class="descname">Java</code><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.Java"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.Java" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="smv.smvdataset.SmvDataSet.Java.implements">
<code class="descname">implements</code><em class="property"> = [‘org.tresamigos.smv.ISmvModule’]</em><a class="headerlink" href="#smv.smvdataset.SmvDataSet.Java.implements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.datasetHash">
<code class="descname">datasetHash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.datasetHash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.datasetHash" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.dependencies">
<code class="descname">dependencies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.dependencies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.dependencies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.description">
<code class="descname">description</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.description"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.description" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.doRun">
<code class="descname">doRun</code><span class="sig-paren">(</span><em>validator</em>, <em>known</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.doRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.doRun" title="Permalink to this definition">¶</a></dt>
<dd><p>Comput this dataset, and return the dataframe</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.dqm">
<code class="descname">dqm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.dqm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.dqm" title="Permalink to this definition">¶</a></dt>
<dd><p>DQM policy</p>
<p>Override this method to define your own DQM policy (optional).
Default is an empty policy.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(SmvDQM): a DQM policy</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.dqmWithTypeSpecificPolicy">
<code class="descname">dqmWithTypeSpecificPolicy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.dqmWithTypeSpecificPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.dqmWithTypeSpecificPolicy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.dsType">
<code class="descname">dsType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.dsType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.dsType" title="Permalink to this definition">¶</a></dt>
<dd><p>Return SmvDataSet’s type</p>
</dd></dl>

<dl class="classmethod">
<dt id="smv.smvdataset.SmvDataSet.fqn">
<em class="property">classmethod </em><code class="descname">fqn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.fqn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.fqn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the fully qualified name</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.getDataFrame">
<code class="descname">getDataFrame</code><span class="sig-paren">(</span><em>validator</em>, <em>known</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.getDataFrame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.getDataFrame" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.isEphemeral">
<code class="descname">isEphemeral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.isEphemeral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.isEphemeral" title="Permalink to this definition">¶</a></dt>
<dd><p>Should this SmvDataSet skip persisting its data?</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(bool): True if this SmvDataSet should not persist its data, false otherwise</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.isOutput">
<code class="descname">isOutput</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.isOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.isOutput" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.publishHiveSql">
<code class="descname">publishHiveSql</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.publishHiveSql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.publishHiveSql" title="Permalink to this definition">¶</a></dt>
<dd><p>An optional sql query to run to publish the results of this module when the
–publish-hive command line is used.  The DataFrame result of running this
module will be available to the query as the “dftable” table.</p>
<blockquote>
<div><dl class="docutils">
<dt>Example:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">return</span> <span class="s2">&quot;insert overwrite table mytable select * from dftable&quot;</span>
</pre></div>
</div>
</dd>
<dt>Note:</dt>
<dd>If this method is not specified, the default is to just create the table specified by tableName() with the results of the module.</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(string): the query to run.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.requiresDS">
<code class="descname">requiresDS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.requiresDS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.requiresDS" title="Permalink to this definition">¶</a></dt>
<dd><p>User-specified list of dependencies</p>
<p>Override this method to specify the SmvDataSets needed as inputs.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(list(SmvDataSet)): a list of dependencies</dd>
</dl>
</dd></dl>

<dl class="classmethod">
<dt id="smv.smvdataset.SmvDataSet.urn">
<em class="property">classmethod </em><code class="descname">urn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.urn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.urn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvDataSet.version">
<code class="descname">version</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvDataSet.version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvDataSet.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Version number</p>
<p>Each SmvDataSet is versioned with a numeric string, so it and its result
can be tracked together.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(str): version number of this SmvDataSet</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="smv.smvdataset.SmvExtDataSet">
<code class="descclassname">smv.smvdataset.</code><code class="descname">SmvExtDataSet</code><span class="sig-paren">(</span><em>refname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvExtDataSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvExtDataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an SmvDataSet representing an external (Scala) SmvDataSet</p>
<p>E.g. MyExtMod = SmvExtDataSet(“the.scala.mod”)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>fqn (str): fqn of the Scala SmvDataSet</dd>
<dt>Returns:</dt>
<dd>(SmvExtDataSet): external dataset with given fqn</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvdataset.SmvExtModuleLink">
<code class="descclassname">smv.smvdataset.</code><code class="descname">SmvExtModuleLink</code><span class="sig-paren">(</span><em>refname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvExtModuleLink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvExtModuleLink" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a link to an external (Scala) SmvDataSet</p>
<p>SmvExtModuleLink(fqn) is equivalent to SmvModuleLink(SmvExtDataSet(fqn))</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>fqn (str): fqn of the the Scala SmvDataSet</dd>
<dt>Returns:</dt>
<dd>(SmvModuleLink): link to the Scala SmvDataSet</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvHiveTable">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvHiveTable</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvHiveTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvHiveTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.smvdataset.SmvInput" title="smv.smvdataset.SmvInput"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.SmvInput</span></code></a></p>
<p>Input from a Hive table</p>
<dl class="method">
<dt id="smv.smvdataset.SmvHiveTable.description">
<code class="descname">description</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvHiveTable.description"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvHiveTable.description" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvHiveTable.doRun">
<code class="descname">doRun</code><span class="sig-paren">(</span><em>validator</em>, <em>known</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvHiveTable.doRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvHiveTable.doRun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="smv.smvdataset.SmvHiveTable.tableName">
<code class="descname">tableName</code><a class="headerlink" href="#smv.smvdataset.SmvHiveTable.tableName" title="Permalink to this definition">¶</a></dt>
<dd><p>User-specified name Hive hive table to extract input from</p>
<p>Override this to specify your own table name.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(str): table name</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvHiveTable.tableQuery">
<code class="descname">tableQuery</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvHiveTable.tableQuery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvHiveTable.tableQuery" title="Permalink to this definition">¶</a></dt>
<dd><p>Query used to extract data from Hive table</p>
<p>Override this to specify your own query (optional). Default is
equivalent to ‘select * from ‘ + tableName().</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(str): query</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvInput">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvInput</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvInput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvInput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.smvdataset.SmvDataSet" title="smv.smvdataset.SmvDataSet"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.SmvDataSet</span></code></a></p>
<p>SmvDataSet representing external input</p>
<dl class="method">
<dt id="smv.smvdataset.SmvInput.dsType">
<code class="descname">dsType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvInput.dsType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvInput.dsType" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvInput.isEphemeral">
<code class="descname">isEphemeral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvInput.isEphemeral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvInput.isEphemeral" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvInput.requiresDS">
<code class="descname">requiresDS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvInput.requiresDS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvInput.requiresDS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvInput.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvInput.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvInput.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Post-processing for input data</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>df (DataFrame): input data</dd>
<dt>Returns:</dt>
<dd>(DataFrame): processed data</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvModule">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvModule</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.smvdataset.SmvDataSet" title="smv.smvdataset.SmvDataSet"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.SmvDataSet</span></code></a></p>
<p>Base class for SmvModules written in Python</p>
<dl class="attribute">
<dt id="smv.smvdataset.SmvModule.IsSmvModule">
<code class="descname">IsSmvModule</code><em class="property"> = True</em><a class="headerlink" href="#smv.smvdataset.SmvModule.IsSmvModule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvModule.RunParams">
<em class="property">class </em><code class="descname">RunParams</code><span class="sig-paren">(</span><em>urn2df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModule.RunParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModule.RunParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Map from SmvDataSet to resulting DataFrame</p>
<p>We need to simulate a dict from ds to df where the same object can be
keyed by different datasets with the same urn. For example, in the
module</p>
<dl class="docutils">
<dt>class X(SmvModule):</dt>
<dd>def requiresDS(self): return [SmvModuleLink(“foo”)]
def run(self, i): return i[SmvModuleLink(“foo”)]</dd>
</dl>
<p>the i argument of the run method should map SmvModuleLink(“foo”) to
the correct DataFrame.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>(dict): a map from urn to DataFrame</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvModule.doRun">
<code class="descname">doRun</code><span class="sig-paren">(</span><em>validator</em>, <em>known</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModule.doRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModule.doRun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvModule.dsType">
<code class="descname">dsType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModule.dsType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModule.dsType" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvModule.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModule.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModule.run" title="Permalink to this definition">¶</a></dt>
<dd><p>User-specified definition of the operations of this SmvModule</p>
<p>Override this method to define the output of this module, given a map
‘i’ from inputSmvDataSet to resulting DataFrame. ‘i’ will have a
mapping for each SmvDataSet listed in requiresDS. E.g.</p>
<dl class="docutils">
<dt>def requiresDS(self):</dt>
<dd>return [MyDependency]</dd>
<dt>def run(self, i):</dt>
<dd>return i[MyDependency].select(“importantColumn”)</dd>
<dt>Args:</dt>
<dd>(RunParams): mapping from input SmvDataSet to DataFrame</dd>
<dt>Returns:</dt>
<dd>(DataFrame): ouput of this SmvModule</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="smv.smvdataset.SmvModuleLink">
<code class="descclassname">smv.smvdataset.</code><code class="descname">SmvModuleLink</code><span class="sig-paren">(</span><em>target</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModuleLink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModuleLink" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a link to an SmvDataSet</p>
<p>When a module X in one stage depends on a module Y in a different stage,
it must do through through an SmvModuleLink (listing Y directly as a
dependency will lead to a runtime error). For example,:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># In stage s1</span>
<span class="k">class</span> <span class="nc">Y</span><span class="p">(</span><span class="n">SmvModule</span><span class="p">):</span>
    <span class="o">...</span>

<span class="c1"># In stage s2</span>
<span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="n">SmvModule</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">requiresDS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">SmvModuleLink</span><span class="p">(</span><span class="n">Y</span><span class="p">)]</span>
    <span class="o">...</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Args:</dt>
<dd>ds (SmvDataSet): dataset to link to</dd>
<dt>Returns:</dt>
<dd>(SmvModuleLink): link to ds</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvModuleLinkTemplate">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvModuleLinkTemplate</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModuleLinkTemplate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModuleLinkTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.smvdataset.SmvModule" title="smv.smvdataset.SmvModule"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.SmvModule</span></code></a></p>
<p>A module link provides access to data generated by modules from another stage</p>
<dl class="attribute">
<dt id="smv.smvdataset.SmvModuleLinkTemplate.IsSmvModuleLink">
<code class="descname">IsSmvModuleLink</code><em class="property"> = True</em><a class="headerlink" href="#smv.smvdataset.SmvModuleLinkTemplate.IsSmvModuleLink" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvModuleLinkTemplate.dsType">
<code class="descname">dsType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModuleLinkTemplate.dsType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModuleLinkTemplate.dsType" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvModuleLinkTemplate.isEphemeral">
<code class="descname">isEphemeral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModuleLinkTemplate.isEphemeral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModuleLinkTemplate.isEphemeral" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvModuleLinkTemplate.requiresDS">
<code class="descname">requiresDS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModuleLinkTemplate.requiresDS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModuleLinkTemplate.requiresDS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="smv.smvdataset.SmvModuleLinkTemplate.target">
<em class="property">classmethod </em><code class="descname">target</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModuleLinkTemplate.target"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModuleLinkTemplate.target" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the target SmvModule class from another stage to which this link points</p>
</dd></dl>

<dl class="classmethod">
<dt id="smv.smvdataset.SmvModuleLinkTemplate.urn">
<em class="property">classmethod </em><code class="descname">urn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvModuleLinkTemplate.urn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvModuleLinkTemplate.urn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvMultiCsvFiles">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvMultiCsvFiles</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvMultiCsvFiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvMultiCsvFiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.smvdataset.WithParser" title="smv.smvdataset.WithParser"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.WithParser</span></code></a>, <a class="reference internal" href="#smv.smvdataset.SmvInput" title="smv.smvdataset.SmvInput"><code class="xref py py-class docutils literal"><span class="pre">smv.smvdataset.SmvInput</span></code></a></p>
<p>Raw input from multiple csv files sharing single schema</p>
<p>Instead of a single input file, specify a data dir with files which share
the same schema.</p>
<dl class="method">
<dt id="smv.smvdataset.SmvMultiCsvFiles.description">
<code class="descname">description</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvMultiCsvFiles.description"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvMultiCsvFiles.description" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="smv.smvdataset.SmvMultiCsvFiles.dir">
<code class="descname">dir</code><a class="headerlink" href="#smv.smvdataset.SmvMultiCsvFiles.dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the directory containing the csv files and their schema</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(str): path</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvMultiCsvFiles.doRun">
<code class="descname">doRun</code><span class="sig-paren">(</span><em>validator</em>, <em>known</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvMultiCsvFiles.doRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvMultiCsvFiles.doRun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvMultiCsvFiles.getRawScalaInputDS">
<code class="descname">getRawScalaInputDS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvMultiCsvFiles.getRawScalaInputDS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvMultiCsvFiles.getRawScalaInputDS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.SmvOutput">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">SmvOutput</code><a class="reference internal" href="_modules/smv/smvdataset.html#SmvOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Mixin which marks an SmvModule as one of the output of its stage</p>
<dl class="docutils">
<dt>SmvOutputs are distinct from other SmvDataSets in that</dt>
<dd><ul class="first last simple">
<li>SmvModuleLinks can <em>only</em> link to SmvOutputs</li>
<li>The -s and –run-app options of smv-pyrun only run SmvOutputs and their dependencies.</li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="smv.smvdataset.SmvOutput.IsSmvOutput">
<code class="descname">IsSmvOutput</code><em class="property"> = True</em><a class="headerlink" href="#smv.smvdataset.SmvOutput.IsSmvOutput" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.SmvOutput.tableName">
<code class="descname">tableName</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#SmvOutput.tableName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.SmvOutput.tableName" title="Permalink to this definition">¶</a></dt>
<dd><p>The user-specified table name used when exporting data to Hive (optional)</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>(string)</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.smvdataset.WithParser">
<em class="property">class </em><code class="descclassname">smv.smvdataset.</code><code class="descname">WithParser</code><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>shared parser funcs</p>
<dl class="method">
<dt id="smv.smvdataset.WithParser.csvAttr">
<code class="descname">csvAttr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser.csvAttr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser.csvAttr" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies the csv file format.  Corresponds to the CsvAttributes case class in Scala.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.WithParser.defaultCsvWithHeader">
<code class="descname">defaultCsvWithHeader</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser.defaultCsvWithHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser.defaultCsvWithHeader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.WithParser.defaultTsv">
<code class="descname">defaultTsv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser.defaultTsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser.defaultTsv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.WithParser.defaultTsvWithHeader">
<code class="descname">defaultTsvWithHeader</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser.defaultTsvWithHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser.defaultTsvWithHeader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.WithParser.dqmWithTypeSpecificPolicy">
<code class="descname">dqmWithTypeSpecificPolicy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser.dqmWithTypeSpecificPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser.dqmWithTypeSpecificPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>for parsers we should get the type specific dqm policy from the
concrete scala proxy class that is the actual input (e.g. SmvCsvFile)</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvdataset.WithParser.failAtParsingError">
<code class="descname">failAtParsingError</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser.failAtParsingError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser.failAtParsingError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.WithParser.forceParserCheck">
<code class="descname">forceParserCheck</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser.forceParserCheck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser.forceParserCheck" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvdataset.WithParser.getRawScalaInputDS">
<code class="descname">getRawScalaInputDS</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvdataset.html#WithParser.getRawScalaInputDS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvdataset.WithParser.getRawScalaInputDS" title="Permalink to this definition">¶</a></dt>
<dd><p>derived classes should provide the raw scala proxy input dataset (e.g. SmvCsvFile)
that is created in their init.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-smv.smvshell">
<span id="smv-smvshell-module"></span><h2>smv.smvshell module<a class="headerlink" href="#module-smv.smvshell" title="Permalink to this headline">¶</a></h2>
<p>Helper functions available in SMV’s Python shell</p>
<dl class="function">
<dt id="smv.smvshell.ancestors">
<code class="descclassname">smv.smvshell.</code><code class="descname">ancestors</code><span class="sig-paren">(</span><em>dsname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#ancestors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.ancestors" title="Permalink to this definition">¶</a></dt>
<dd><p>List all ancestors of a dataset</p>
<p>Ancestors of a dataset are the dataset it depends on, directly or
in-directly, including datasets from other stages.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>dsname (str): The name of an SmvDataSet</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.descendants">
<code class="descclassname">smv.smvshell.</code><code class="descname">descendants</code><span class="sig-paren">(</span><em>dsname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#descendants"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.descendants" title="Permalink to this definition">¶</a></dt>
<dd><p>List all descendants of a dataset</p>
<p>Descendants of a dataset are the datasets which depend on it directly or
in-directly, including datasets from other stages</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>dsname (str): The name of an SmvDataSet</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.df">
<code class="descclassname">smv.smvshell.</code><code class="descname">df</code><span class="sig-paren">(</span><em>name</em>, <em>forceRun=False</em>, <em>version=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.df" title="Permalink to this definition">¶</a></dt>
<dd><p>The DataFrame result of running the named module</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>name (str): The name of a module. Does not have to be the FQN.
forceRun (bool): True if the module should be forced to run even if it has persisted output. False otherwise.</dd>
<dt>Returns:</dt>
<dd>(DataFrame): The result of running the named module.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.discoverSchema">
<code class="descclassname">smv.smvshell.</code><code class="descname">discoverSchema</code><span class="sig-paren">(</span><em>path</em>, <em>n=100000</em>, <em>ca=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#discoverSchema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.discoverSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Try best to discover Schema from raw Csv file</p>
<p>Will save a schema file with postfix “.toBeReviewed” in local directory.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (str): Path to te CSV file
n (int): Number of records to check for schema discovery, default 100k
ca (CsvAttributes): Defaults to CsvWithHeader</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.graph">
<code class="descclassname">smv.smvshell.</code><code class="descname">graph</code><span class="sig-paren">(</span><em>stageName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Print ascii graph of all datasets in a given stage or all stages</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>dsname (str): The name of an SmvDataSet</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.graphStage">
<code class="descclassname">smv.smvshell.</code><code class="descname">graphStage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#graphStage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.graphStage" title="Permalink to this definition">¶</a></dt>
<dd><p>Print ascii graph of all stages (not datasets)</p>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.help">
<code class="descclassname">smv.smvshell.</code><code class="descname">help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#help"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a list of the SMV helper functions available in the shell</p>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.ls">
<code class="descclassname">smv.smvshell.</code><code class="descname">ls</code><span class="sig-paren">(</span><em>stageName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#ls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.ls" title="Permalink to this definition">¶</a></dt>
<dd><p>List all datasets in a stage</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>stageName (str): The name of the stage. Defaults to None, in which ase all datasets in all stages will be listed.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.lsDead">
<code class="descclassname">smv.smvshell.</code><code class="descname">lsDead</code><span class="sig-paren">(</span><em>stageName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#lsDead"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.lsDead" title="Permalink to this definition">¶</a></dt>
<dd><p>List dead datasets in a stage</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>stageName (str): The name of the stage. Defaults to None, in which ase all datasets in all stages will be listed.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.lsDeadLeaf">
<code class="descclassname">smv.smvshell.</code><code class="descname">lsDeadLeaf</code><span class="sig-paren">(</span><em>stageName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#lsDeadLeaf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.lsDeadLeaf" title="Permalink to this definition">¶</a></dt>
<dd><p>List ‘deadLeaf’ datasets in a stage</p>
<p>A ‘deadLeaf’ dataset is dataset for which “no modules in the stage depend
on it, excluding Output modules”</p>
<p>Note: a <cite>deadLeaf</cite> dataset must be <cite>dead</cite>, but some <cite>dead</cite> datasets aren’t
<cite>leaves</cite>.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>stageName (str): The name of the stage. Defaults to None, in which ase all datasets in all stages will be listed.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.lsStage">
<code class="descclassname">smv.smvshell.</code><code class="descname">lsStage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#lsStage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.lsStage" title="Permalink to this definition">¶</a></dt>
<dd><p>List all the stages</p>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.now">
<code class="descclassname">smv.smvshell.</code><code class="descname">now</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#now"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.now" title="Permalink to this definition">¶</a></dt>
<dd><p>Print current time</p>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.openCsv">
<code class="descclassname">smv.smvshell.</code><code class="descname">openCsv</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#openCsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.openCsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a CSV file as a DataFrame</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>path (str): The path of the CSV file</dd>
<dt>Returns:</dt>
<dd>(DataFrame): The resulting DataFrame</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.openHive">
<code class="descclassname">smv.smvshell.</code><code class="descname">openHive</code><span class="sig-paren">(</span><em>tableName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#openHive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.openHive" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a Hive table as a DataFrame</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>tableName (str): The name of the Hive table</dd>
<dt>Returns:</dt>
<dd>(DataFrame): The resulting DataFrame</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-smv.utils">
<span id="smv-utils-module"></span><h2>smv.utils module<a class="headerlink" href="#module-smv.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="smv.utils.check_socket">
<code class="descclassname">smv.utils.</code><code class="descname">check_socket</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#check_socket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.check_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the given port is open to bind</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.for_name">
<code class="descclassname">smv.utils.</code><code class="descname">for_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#for_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.for_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamically load a class by its name.</p>
<p>Equivalent to Java’s Class.forName</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.smv_copy_array">
<code class="descclassname">smv.utils.</code><code class="descname">smv_copy_array</code><span class="sig-paren">(</span><em>sc</em>, <em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#smv_copy_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.smv_copy_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy Python list to appropriate Java array</p>
</dd></dl>

</div>
<div class="section" id="module-smv">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-smv" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">smv package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-smv.csv_attributes">smv.csv_attributes module</a></li>
<li><a class="reference internal" href="#module-smv.datasetrepo">smv.datasetrepo module</a></li>
<li><a class="reference internal" href="#module-smv.dqm">smv.dqm module</a></li>
<li><a class="reference internal" href="#module-smv.error">smv.error module</a></li>
<li><a class="reference internal" href="#module-smv.functions">smv.functions module</a></li>
<li><a class="reference internal" href="#module-smv.graph">smv.graph module</a></li>
<li><a class="reference internal" href="#module-smv.helpers">smv.helpers module</a></li>
<li><a class="reference internal" href="#module-smv.matcher">smv.matcher module</a></li>
<li><a class="reference internal" href="#module-smv.runconfig">smv.runconfig module</a></li>
<li><a class="reference internal" href="#module-smv.smvapp">smv.smvapp module</a></li>
<li><a class="reference internal" href="#module-smv.smvdataset">smv.smvdataset module</a></li>
<li><a class="reference internal" href="#module-smv.smvshell">smv.smvshell module</a></li>
<li><a class="reference internal" href="#module-smv.utils">smv.utils module</a></li>
<li><a class="reference internal" href="#module-smv">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to smv’s documentation!</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/smv.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Author.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/smv.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>